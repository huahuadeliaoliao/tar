[registration]
token = "CHANGE_ME"

[jwt]
secret_key = "change-this-secret"
algorithm = "HS256"
access_token_expire_minutes = 30
refresh_token_expire_days = 7

[database]
url = "sqlite:///./data/app.db"

[openai]
base_url = "https://api.openai.com/v1"
api_key = "sk-your-api-key"

[[openai.available_models]]
id = "gpt-5-chat-latest"
name = "GPT-5"
supports_vision = true

[[openai.available_models]]
id = "qwen3-vl-235b-a22b-thinking"
name = "Qwen"
supports_vision = true

[[openai.available_models]]
id = "o4-mini"
name = "o4-mini"
supports_vision = true

[[openai.available_models]]
id = "gpt-5-mini-2025-08-07"
name = "GPT-5-mini"
supports_vision = true

[web_search]
models = [
  "gpt-5-thinking-all",
  "doubao-seed-1-6-251015-search",
  "kimi-k2-0711-preview-search",
]
timeout = 100

[ddgs]
default_category = "text"
default_backend = "auto"
default_region = "us-en"
default_safesearch = "moderate"
default_timelimit = ""
timeout = 10
verify_ssl = true
proxy = ""
max_threads = 16
cache_ttl_seconds = 60
cache_maxsize = 128

[llm]
temperature = 0.5
top_p = 1.0
frequency_penalty = 0.0
presence_penalty = 0.0

[prompts]
system = """You are an autonomous assistant whose primary advantage is the **reasoning tool**. Your job is to analyze every user message, decide whether deeper planning is required, and use reasoning to stay organized before you deliver conclusions. Before finalizing an answer, double-check that every factual claim is either supported by recent search/browse tool evidence or clearly labelled as a hypothesis.

## Core Principles

1. **Assess each turn.** Before producing *any* response or tool call, pause and explicitly classify the current request in your internal thoughts as either *simple* (safe to answer from existing knowledge) or *complex* (multi-step, uncertain, or high stakes). If you are unsure, default to **complex**.
2. **Complex ⇒ reasoning required.** For every turn classified as complex (or when uncertainty exists), immediately call the `reasoning` tool to create or update a plan. Treat the reasoning output as your working memory and follow the plan step by step. Call reasoning again whenever the situation changes, you reach a milestone, or you feel uncertain.
3. **Ready-to-reply gate.** If reasoning sets `ready_to_reply = false`, you must continue executing the plan—no final answer yet. Only after another reasoning call returns `ready_to_reply = true` may you craft the final response.
4. **Final responses for complex tasks.** When you do answer, briefly recap the key steps you executed and state your confidence level. If gaps remain, be explicit and suggest next actions.
5. **System enforcement.** If you answer without honoring the rules above, the system may block your reply. Should that happen, re-run reasoning, finish the pending actions, and try again.

## Mindset & Communication

- Default to the user’s language and be concise, structured, and transparent.
- Make it clear when you are still working versus when you have finished.
- If you ever lack enough information, say so and explain how to proceed.
- Always invoke tools via the structured tool-call channel—**never print tool-call JSON as plain text** or describe the raw payload unless the user explicitly asks.
- Tool calls must be issued only through the structured `tool_calls` API. Printing JSON like `{"name": "...", "arguments": {...}}` inside your text output is invalid and will be discarded; always emit tool calls via the dedicated channel instead.
- Only one tool call is permitted per turn. If multiple tools are needed, invoke them sequentially across turns.
- When a tool call is rejected or blocked, do not attempt to “fake” the result; instead, re-run reasoning, adjust your plan, and try again.
- Summaries and final answers should focus on conclusions and insights; reserve tool-call details for the execution log unless the user requests them.
"""
tool_error = "The tool call failed with an error. Please acknowledge the error and either try a different approach or provide the best answer you can without that tool's result."
multiple_tools_warning = "You can only call ONE tool at a time. Please choose the most important tool to call first."

[prompts.self_check]
final_response = "Before finalizing your reply, confirm whether every factual statement is grounded in search/browse evidence. If something stems from general knowledge or inference, explicitly mark it as uncertain."

[file_uploads]
max_file_size = 52428800

[file_uploads.allowed_file_types]
image = ["image/png", "image/jpeg", "image/jpg", "image/gif", "image/webp"]
pdf = ["application/pdf"]
docx = [
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  "application/wps-office.docx",
  "application/msword",
  "application/vnd.ms-word.document.macroEnabled.12",
]
ppt = [
  "application/vnd.ms-powerpoint",
  "application/vnd.openxmlformats-officedocument.presentationml.presentation",
  "application/wps-office.ppt",
  "application/wps-office.pptx",
  "application/vnd.ms-powerpoint.presentation.macroEnabled.12",
]

[file_uploads.image]
format = "webp"
compression_quality = 75
max_dimension = 2048

[libreoffice]
timeout = 120
path = "/usr/bin/libreoffice"
pdf_to_image_dpi = 150

[agent]
max_iterations = 50
max_retry_on_multiple_tools = 3

[background_tasks]
max_workers = 8

[playwright]
default_timeout_ms = 30000
navigation_timeout_ms = 30000
default_wait_until = "load"
max_actions = 20
max_extractions = 20
max_html_chars = 150000
max_markdown_chars = 20000
browsers_path = "/ms-playwright"
max_download_file_size_bytes = 31457280
